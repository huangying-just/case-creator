# æ¡ˆä¾‹æ”¹ç¼–ä¸“å®¶ - éƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

```bash
# ä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬
chmod +x start.sh
./start.sh
```

### Docker å®¹å™¨ç¯å¢ƒ

```bash
# ä½¿ç”¨Dockerä¸“ç”¨å¯åŠ¨è„šæœ¬
chmod +x docker-start.sh
./docker-start.sh
```

## ğŸ“‹ éƒ¨ç½²æ–¹å¼å¯¹æ¯”

| ç¯å¢ƒ | å¯åŠ¨è„šæœ¬ | é€‚ç”¨åœºæ™¯ | ç‰¹ç‚¹ |
|------|----------|----------|------|
| æœ¬åœ°å¼€å‘ | `start.sh` | å¼€å‘è°ƒè¯• | è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒï¼Œæ”¯æŒçƒ­é‡è½½ |
| Dockerå®¹å™¨ | `docker-start.sh` | ç”Ÿäº§éƒ¨ç½² | å®¹å™¨ä¼˜åŒ–ï¼Œè‡ªåŠ¨é‡å¯ï¼ŒæœåŠ¡ç›‘æ§ |

## ğŸ”§ æ‰‹åŠ¨éƒ¨ç½²

### åç«¯å¯åŠ¨

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install --upgrade pip
pip install -r requirements.txt

# å¯åŠ¨æœåŠ¡
python3 run.py
```

### å‰ç«¯å¯åŠ¨

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

## ğŸŒ å¤–ç½‘è®¿é—®é…ç½®

### 1. å‰ç«¯é…ç½®ï¼ˆå·²å®Œæˆï¼‰

å‰ç«¯å·²é…ç½®ä¸ºæ”¯æŒå¤–ç½‘è®¿é—®ï¼š
- `vite.config.js` ä¸­è®¾ç½® `host: '0.0.0.0'`
- `package.json` ä¸­æ·»åŠ  `--host 0.0.0.0` å‚æ•°
- é…ç½®äº† `allowedHosts` æ”¯æŒåŸŸåè®¿é—®

### 2. åç«¯é…ç½®ï¼ˆå·²å®Œæˆï¼‰

åç«¯å·²é…ç½®ä¸ºæ”¯æŒå¤–ç½‘è®¿é—®ï¼š
- Flaskåº”ç”¨ç»‘å®šåˆ° `0.0.0.0:8865`

### 3. åŸŸåè®¿é—®

å¦‚æœä½¿ç”¨åŸŸåè®¿é—®ï¼Œéœ€è¦åœ¨ `frontend/vite.config.js` ä¸­æ·»åŠ æ‚¨çš„åŸŸååˆ° `allowedHosts` æ•°ç»„ï¼š

```javascript
allowedHosts: [
  'your-domain.com',  // æ·»åŠ æ‚¨çš„åŸŸå
  'case.cflp.ai',     // ç¤ºä¾‹åŸŸå
  'localhost',
  '127.0.0.1'
]
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   # æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
   lsof -i :8865  # åç«¯ç«¯å£
   lsof -i :8866  # å‰ç«¯ç«¯å£
   
   # æ€æ­»è¿›ç¨‹
   kill -9 <PID>
   ```

2. **è™šæ‹Ÿç¯å¢ƒé—®é¢˜**
   ```bash
   # åˆ é™¤è™šæ‹Ÿç¯å¢ƒé‡æ–°åˆ›å»º
   rm -rf backend/venv
   cd backend
   python3 -m venv venv
   ```

3. **ä¾èµ–å®‰è£…å¤±è´¥**
   ```bash
   # æ¸…ç†npmç¼“å­˜
   npm cache clean --force
   
   # åˆ é™¤node_modulesé‡æ–°å®‰è£…
   rm -rf frontend/node_modules
   cd frontend && npm install
   ```

4. **Dockerå®¹å™¨ä¸­çš„æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
   chmod +x docker-start.sh
   
   # æ£€æŸ¥æ–‡ä»¶æ‰€æœ‰æƒ
   chown -R www-data:www-data /app
   ```

## ğŸ”’ å®‰å…¨é…ç½®

### ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **ç¯å¢ƒå˜é‡é…ç½®**
   - è®¾ç½®å¼ºå¯†ç çš„ `SECRET_KEY`
   - é…ç½®æ­£ç¡®çš„ `OPENROUTER_API_KEY`
   - è®¾ç½® `FLASK_DEBUG=false`

2. **ç½‘ç»œå®‰å…¨**
   - é…ç½®é˜²ç«å¢™è§„åˆ™
   - ä½¿ç”¨åå‘ä»£ç†ï¼ˆNginxï¼‰
   - å¯ç”¨HTTPS

3. **æœåŠ¡ç›‘æ§**
   - ä½¿ç”¨ PM2 æˆ– systemd ç®¡ç†è¿›ç¨‹
   - é…ç½®æ—¥å¿—è½®è½¬
   - è®¾ç½®å¥åº·æ£€æŸ¥

## ğŸ“Š æœåŠ¡ç›‘æ§

### å¥åº·æ£€æŸ¥ç«¯ç‚¹

- åç«¯çŠ¶æ€ï¼š`http://localhost:8865/api/workflow/status`
- å‰ç«¯é¡µé¢ï¼š`http://localhost:8866`

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
tail -f backend.log

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
tail -f frontend.log
```

## ğŸ¯ è®¿é—®åœ°å€

éƒ¨ç½²æˆåŠŸåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **å‰ç«¯ç•Œé¢**: `http://your-server:8866`
- **åç«¯API**: `http://your-server:8865`
- **åŸŸåè®¿é—®**: `http://case.cflp.ai:8866` (å¦‚å·²é…ç½®)

## âš¡ æ€§èƒ½ä¼˜åŒ–

### ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–

1. **å‰ç«¯æ„å»º**
   ```bash
   cd frontend
   npm run build
   ```

2. **ä½¿ç”¨ç”Ÿäº§çº§æœåŠ¡å™¨**
   - åç«¯ï¼šä½¿ç”¨ Gunicorn æ›¿ä»£ Flask å¼€å‘æœåŠ¡å™¨
   - å‰ç«¯ï¼šä½¿ç”¨ Nginx æä¾›é™æ€æ–‡ä»¶æœåŠ¡

3. **ç¼“å­˜é…ç½®**
   - å¯ç”¨æµè§ˆå™¨ç¼“å­˜
   - é…ç½® CDN
   - ä½¿ç”¨ Redis ç¼“å­˜APIå“åº” 